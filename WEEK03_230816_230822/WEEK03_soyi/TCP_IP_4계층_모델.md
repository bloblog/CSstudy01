# TCP/IP 4계층 모델

- 인터넷 프로토콜 스위트(internet protocol suite)
  : 인터넷에서 컴퓨터들이 서로 정보를 주고받는 데 쓰이는 프로토콜의 집합
  - TCP/IP 4계층 모델 혹은 OSI 7계층 모델로 설명한다.
    - TCP/IP (Transmission Control Protocol / Internet Protocol)
      : 네트워크에서 사용되는 통신 프로토콜의 집합. 프로토콜 네트워킹 범위에 따라 4개의 추상화 계층으로 구성.

## 계층 구조

### 애플리케이션 계층

: 웹 서비스, 이메일 등 서비스를 실질적으로 사람들에게 제공하는 층.

- FTP
  : 장치와 장치 간의 파일을 전송하는 데 사용되는 표준 통신 프로토콜
- HTTP
  : World Wide Web을 위한 데이터 통신의 기초이자 웹 사이트를 이용하는 데 쓰는 프로토콜
- SSH
  : 보안되지 않은 네트워크에서 네트워크 서비스를 안전하게 운영하기 위한 암호화 네트워크 프로토콜
- SMTP
  : 전자 메일 전송을 위한 인터넷 표준 통신 프로토콜
- DNS
  : 도메인 이름과 IP 주소를 매핑해주는 서버.
  IP주소가 바뀌어도 사용자들에게 똑같은 도메인 주소로 서비스할 수 있다.

### 전송 계층

: 송신자와 수신자를 연결하는 통신서비스를 제공하며 연결 지향 데이터 스트림 지원, 신뢰성, 흐름 제어를 제공할 수 있으며 애플리케이션과 인터넷 계층 사이의 데이터가 전달될 때 중계 역할을 한다.

- TCP
  - 신뢰성을 구축해 수신 여부 확인
    - 패킷 사이의 순서를 보장
    - 연결 지향 프로토콜 사용
  - 가상회선 패킷 교환 방식
    - 각 패킷에는 식별자가 포함되며 모든 패킷을 전송하면 가상화선이 해제
    - 패킷들은 전송된 순서대로 도착
  - 3-웨이-핸드셰이크 (3-way handshake) → 연결
    1. SYN : 클라이언트는 서버에 클라이언트의 ISN(새로운 TCP 연결의 첫 번째 패킷에 할당된 임의의 시퀀스 번호)을 담아 보낸다
    2. SYN + ACK : 서버는 클라이언트의 SYN을 수신하고 서버의 ISN을 보내며 승인번호로 클라이언트의 ISN + 1을 보낸다
    3. ACK : 클라이언트의 서버는 ISN + 1 한 값인 승인번호를 담아 ACK를 서버에 보낸다.
  - 4-웨이-핸드셰이크 (4-way handshake) → 연결 해제
    1. 클라이언트가 연결을 닫으려고 할 때, FIN으로 설정된 세그먼트를 보낸다. 클라이언트는 FIN_WAIT_1 상태로 들어가고 서버의 응답을 기다린다
    2. 서버는 클라이언트로 ACK라는 승인 세그먼트를 보내고 CLOSE_WAIT 상태로 들어간다. 클라이언트가 세그먼트를 받으면 FIN_WAIT_2 상태에 들어간다.
    3. 서버는 ACK를 보내고 일정 시간 이후에 클라이언트에 FIN이라는 세그먼트를 보낸다.
    4. 클라이언트는 **TIME_WAIT** 상태가 되고 다시 서버로 ACK를 보내서 서버는 CLOSED 상태가 된다. 이후 클라이언트는 어느 정도 시간을 대기한 후 연결이 닫히고 클라이언트와 서버의 모근 자원의 연결이 해제된다.
- UDP
  - 순서를 보장하지 않고 수신 여부를 확인하지 않음
  - 데이터그램 패킷 교환 방식
    - 패킷이 독립적으로 이동하며 최적의 경로를 선택
    - 여러 분할된 패킷은 서로 다른 경로로 전송될 수 있으며 도착하는 순서가 다를 수 있다.
- QUIC

### 인터넷 계층

: 장치로부터 받은 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위해 사용되는 계층.

패킷을 수신해야 할 상대의 주소를 지정하여 데이터를 전달 → 수신 여부 보장 X (비연결형)

- IP
- ARP
- ICMP

### 링크 계층

: 전선, 광섬유, 무선 등으로 실질적으로 데이터를 전달하며 장치 간에 신호를 주고받는 규칙을 정하는 계층. (= 네트워크 접근 계층)

- 이더넷

## PDU (Protocol Data Unit)

: 네트워크의 어떠한 계층에서 계층으로 데이터가 전달될 때 한 덩어리의 단위.
