# 운영체제와 컴퓨터 / 메모리

날짜: 2023/09/06
태그: study
세부항목: CS스터디, SSAFY, study
velog/blog/git: XXX

# 3. 운영 체제

## 3.1 운영체제와 컴퓨터

### 3.1.1 운영체제의 역할과 구조

- 운영체제의 역할
    - CPU 스케줄링과 프로세스 관리
    - 메모리 관리
    - 디스크 파일 관리
    - I/O 디바이스 관리

- 운영체제의 구조
    - GUI
    - 시스템콜
    - 커널
    - 드라이브

- 시스템 콜
    - 운영체제가 커널에 접근하기 위한 인터페이스
    - 유저 프로그램이 운영체제의 서비스를 받기 위해 커널 함수를 호출할 때 씀
    - 유저 프로그램이 I/O 요청으로 트랩을 발동하면 올바른 I/O 요청인지 확인한 후 유저모드가 시스템 콜을 통해 커널 모드로 변환되어 실행 됨
    - 커널 모드 : 유저 모드가 아닌 커널 모드 → 컴퓨터 자원에 대한 직접 접근 차단을 위한 구조
    
    ** I/O 요청
    
    입출력 함수, 데이터베이스, 네트워크, 파일 접근 등에 관한 일
    
    ** 드라이버
    
    하드웨어를 제어하기 위한 소프트웨어
    
    - 프로세스나 스레드에서 운영체제로 어떠한 요청을 할 때 시스템 콜이라는 인터페이스와 커널을 거쳐 운영체제에 전달됨
    - 추상화 계층 → 이를 통해 네트워크 통신이나 데이터베이스와 같은 낮은 단계의 영역 처리에 대한 부분을 많이 신경 쓰지 않고 프로그램 구현 가능
    
    - modebit
        - 시스템 콜이 작동될 때 참고 → 유저 모드와 커널 모드 구분
        - 플래그 변수(0or1)
        - ex) 카메라, 키보드 등을 운영체제를 통해서만 작동함
    
    **유저모드
    
    유저가 접근할 수 있는 영역을 제한적으로 두는 모드
    
    ↔ 커널 모드
    
    ** 커널
    
    운영체제의 핵심부분이자 시스템콜 인터페이스를 제공하며 보안, 메모리, 프로세스, 파일 시스템, I/O 디바이스, I/O요청 관리 등 운영체제의 중추적인 역할을 함
    

---

### 3.1.2 컴퓨터의 요소

- CPU
    - Central Processing Unit | 산술논리연산장치 | 제어장치 | 레지스터
    - 인터럽트에 의해 단순히 메모리에 존재하는 명령어를 해석해서 실행하는 일꾼
    
    - 제어장치
        - Control Unit
        - 프로세스 조작을 지시하는 CPU의 한 부품
        - 입출력 간 통신을 제어하고 명령어들을 읽고 해석하며, 데이터 처리를 위한 순서를 결정
    - 레지스터
        - 매우 빠른 임시기억 장치
        - CPU와 직접 연결 → 연산 속도가 메모리보다 수십 배에서 수백 배까지 빠름
        - 자체적으로 데이터를 저장할 방법이 없음 → 레지스터를 거쳐 데이터를 전달
    - 산술논리연산장치
        - ALU Arithmeric Logic Unit
        - 산술 연산, 배타적 논리합, 논리곱 같은 논리 연산 계산
        
    - CPU의 연산 처리
        1. 메모리에 계산할 값을 로드
        2. 레지스터에 있는 값을 계산
        3. 레지스터에서 메모리로 계산한 값을 저장
    
    - 인터럽트
        - 어떤 신호가 들어왔을때 CPU를 잠깐 정지시킴
        - 인터럽트 핸들러 함수
            - 커널 내부의 IRQ를 통해 호출됨
        - 하드웨어 인터럽트
            - 키보드를 연결, 마우스를 연결 등 IO 디바이스에서 발생하는 인터럽트
        - 소프트웨어 인터럽트
            - 트랩 : 프로세스 오류 등으로 프로세스가 시스템콜을 호출할 때 발동
    
- DMA 컨트롤러
    - I/O 디바이스가 메모리에 직접 접근할 수 있도록 하는 하드웨어 장치
    - CPU에 너무 많은 인터럽트 요청이 들어오기 때문 → CPU의 부하를 막는 역할

- 메모리
    - 전자회로에서 데이터나 상태, 명령어 등을 기록하는 장치
    - RAM을 일컬어 메모리라고 함
    - CPU는 계산을 담당 → 메모리는 기억을 담당
- 타이머
    - 몇 초 안에 작업이 끝나야 한다는 것을 정함
    - 특정 프로그램에 시간 제한을 다는 역할
    - 시간이 많이 걸리는 프로그램이 작동할 때 제한을 걸기 위해 존재
- 디바이스 컨트롤러
    - 컴퓨터와 연결되어 있는 IP 디바이스들의 작은 CPU를 말함
    - 로컬 버퍼 → 각 디바이스에서 데이터를 임시로 저장하기 위한 작은 메모리를 뜻함

---

## 3.2 메모리

### 3.2.1 메모리 계층

- 메모리 계층
    
    레지스터 | 캐시 | 메모리 | 저장장치
    
    - 레지스터
        - CPU 안에 있는 작은 메모리
        - 휘발성, 속도 가장 빠름
        - 기억 용량이 적음
    - 캐시
        - L1, L2 캐시를 지칭
        - 휘발성, 속도 빠름, 기억 용량이 적음
    - 주기억장치
        - RAM
        - 휘발성, 속도 보통, 기억용량 보통
    - 보조기억장치
        - HDD, SSD
        - 비휘발성, 속도 낮음, 기억용량이 많음
- 램
    - 하드디스크로부터 일정량의 데이터를 복사해서 임시 저장
    - 필요 시 마다 CPU에 빠르게 전달하는 역할
    - 경제성 때문에 메모리를 계층별로 관리하는 것

- 캐시
    - 데이터를 미리 복사해 놓는 임시 저장소
    - 빠른 장치와 느린 장치에서 속도 차이에 따른 병목 현상을 줄이기 위한 메모리
    - 데이터를 접근하는 시간이 오래 걸리는 경우를 해결/무언가를 다시 계산하는 시간을 절약 가능
    - 속도 차이를 해결하기 위한 계층 → 캐싱 계층
        - 캐시 메모리와 보조기억장치 사이에 있는 주기억장치는 보조기억장치의 캐싱 계층
    
    - 지역성의 원리
        - 자주 사용하는 데이터를 기반으로 캐시 설정
        - 시간 지역성, 공간 지역성
    
    - 시간 지역성
        - 최근 사용한 데이터에 다시 접근하려는 특성
    - 공간 지역성
        - 최근 접근한 데이터를 이루고 있는 공간이나 그 가까운 공간에 접근하는 특성

- 캐시히트와 캐시미스
    - 캐시히트
        - 캐시에서 원하는 데이터를 찾은 것
    - 캐시미스
        - 원하는 데이터가 캐시에 없다면 → 주메모리로 가서 데이터를 찾아오는 것

- 캐시매핑
    - 캐시가 히트되기 위해 매핑하는 방법
    - CPU의 레지스터와 주 메모리 간에 데이터를 주고 받을 때 기반으로 설명
    - 레지스터는 주 메모리에 비하면 작음 → 매핑이 중요
    
    - 직접 매핑
    - 연관 매핑
    - 집합 연관 매핑

- 웹 브라우저의 캐시
    - 쿠키
        - 만료기한이 있는 키-값 저장소
    - 로컬 스토리지
        - 만료기한이 없는 키-값 저장소
    - 세션 스토리지
        - 만료기하닝 없는 키-값 저장소
        - 탭 단위로 세션 스토리지를 생성 → 탭을 닫을 때 해당 데이터 삭제
    
- 데이터베이스의 캐싱 계층
    - redis데이터베이스 계층을 캐싱 계층으로 둬서 성능 향상 시키기도

---

### 3.2.2 메모리 관리

- 가상 메모리
    - 메모리 관리 기법의 하나
    - 컴퓨터가 실제로 이용 가능한 메모리 자원을 추상화 → 사용하는 사용자들에게 매우 큰 메모리로 보이게 만드는 것
    - //더 찾아봐야할듯
    - TLB를 사용함
        - 메모리와 CPU  사이에 있는 주소 변환을 위한 캐시
    - 스와핑
        - 가상 메모리에는 존재 but RAM에는 없는 데이터나 코드에 접근하면 → 페이지 폴트가 발생
        - 메모리에서 당장 사용하지 않는 영역을 하드디스크로 옮기고 일부를 마치 메모리처럼 불러와 쓰는 것을 스와핑이라고 함
    - 페이지 폴트
        - 프로세스의 주소 공간에는 존재하지만 지금 이 컴퓨터의 RAM에는 없는 데이터에 접근했을 경우 발생

- 스레싱
    - 메모리의 페이지 폴트율이 높은 것 → 성능 저하 초래
    - 메모리에 너무 많은 프로세스가 동시에 올라가게 됨 → 스와핑이 많이 일어남
        - CPU의 이용률이 낮아진다. ⇒ 더 많은 프로세스 시도
    
    - 작업 세트
        - 프로세스의 과거 사용 이력인 지역성을 통해 결성된 페이지 집합 →미리 메모리에 로드(탐색에 드는 비용 줄어듦)
    - PFF Page Fault Frequency
        - 페이지 폴트 빈도를 조절
        
- 메모리 할당
    - 연속 할당
        - 연속적으로 공간 할당
        - 고정 분할 방식
            - 메모리를 미리 나누어
        - 가변 분할 방식
            - 시점 프로그램의 크기에 맞게 동적으로 메모리를 나눔
            - 최초적합
            - 최적적합
            - 최악적합
    
    **내부 단편화
    
    **외부 단편화
    
    ** 홀
    
    - 불연속 할당
        
        : 현대 운영체제가 쓰는 방법
        
        - 페이징
            - 동일한 크기의 페이지 단위로 나누어 메모리의 서로 다른 위치에 프로세스 할당
        - 세그멘테이션
            - 페이지 단위가 아닌, 의미 단위인 세그먼트로 나누는 방식
        - 페이지드 세그멘테이션
            - 프로그램을 의미 단위인 세그먼트로 나눠, 공유나 보안 측면에 강점을 두고 임의의 길이가 아닌 동일한 크기의 페이지 단위로 나누는 것
- 페이지 교체 알고리즘
    - 오프라인 알고리즘
        - 먼 미래에 참조 되는 페이지와 현재 할당하는 페이지를 바꾸는 알고리즘
        - 실행 불가 BUT 가장 이상적
    - FIFO
        - 가장 먼저 온 페이지를 교체 영역에 두는 법
    - LRU
        - 참조가 가장 오래된 페이지를 바꿈
    - NUR
        - LRU에서 발전
        - clock 알고리즘
    - LFU
        - 가장 참조 횟수가 적은 페이지를 교체